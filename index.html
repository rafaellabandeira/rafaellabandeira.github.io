<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Caba√±as R√≠o Mundo | Casas Rurales en Ri√≥par</title>
<meta name="description" content="Caba√±as rurales en Ri√≥par, junto al Nacimiento del R√≠o Mundo. Piscina en verano, entorno natural y contacto directo por WhatsApp.">
<meta name="keywords" content="caba√±as r√≠o mundo, casas rurales ri√≥par, alojamiento rural albacete">
<link rel="canonical" href="https://casaruralriomundo.es">
<link rel="icon" href="images/favicon.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="images/favicon.svg">

<link rel="stylesheet" href="css/global.css">
<link rel="stylesheet" href="css/index.css">

<style>
/* ===== MOTOR DE RESERVAS ===== */
.reserva-box{
  border:2px solid #e3e3e3;
  padding:25px;
  max-width:450px;
  margin:40px auto;
  border-radius:12px;
  background:#fafafa;
  box-shadow:0 4px 12px rgba(0,0,0,0.08);
}
.reserva-box label{
  display:block;
  margin-top:15px;
  font-weight:600;
}
.reserva-box input, .reserva-box select{
  width:100%;
  padding:10px;
  margin-top:5px;
  border-radius:6px;
  border:1px solid #ccc;
}
.reserva-box button{
  margin-top:20px;
  padding:12px;
  width:100%;
  background:#2f5d50;
  color:white;
  border:none;
  border-radius:6px;
  font-size:16px;
  cursor:pointer;
}
.reserva-box button:hover{
  background:#25473d;
}
.spinner{
  margin:20px auto;
  width:35px;
  height:35px;
  border:4px solid #ddd;
  border-top:4px solid #2f5d50;
  border-radius:50%;
  animation:spin 1s linear infinite;
  display:none;
}
.resumen-reserva{
  border-radius:10px;
  padding:15px;
  margin-top:20px;
  text-align:left;
  color:#333;
  font-weight:500;
}
.descuento{ color:#e67e22; font-weight:700; }
.campanilla{ background:#d0f0e0; }
.tejo{ background:#d0e0f5; }
</style>
</head>

<body>

<nav class="navbar">
  <div class="nav-container">
    <a href="index.html" class="nav-logo">üè° Caba√±as R√≠o Mundo</a>
    <div class="hamburger" id="hamburger"><span></span><span></span><span></span></div>
    <ul class="nav-menu" id="navMenu">
      <li><a href="cabana-campanilla.html" class="nav-link">Campanilla</a></li>
      <li><a href="cabana-el-tejo.html" class="nav-link">El Tejo</a></li>
      <li><a href="https://casaruralriomundo.wordpress.com/" class="nav-link" target="_blank">Experiencias</a></li>
      <li><a href="#contacto" class="nav-link">Contacto</a></li>
    </ul>
  </div>
</nav>

<header class="hero">
  <div class="header-inner">
    <div class="header-text">
      <h1 class="hero-title">Casas rurales en Ri√≥par ¬∑ <span>Complejo El Lagunazo</span></h1>
      <p class="hero-sub">Escapadas, naturaleza y tranquilidad junto al Nacimiento del R√≠o Mundo</p>
    </div>
  </div>
</header>

<section>
  <h2>Tu escapada rural en Ri√≥par</h2>
  <p>Disponemos de dos acogedoras caba√±as rurales situadas en el exclusivo complejo El Lagunazo.</p>
</section>

<section>
  <h2>Nuestras exclusivas Caba√±as</h2>
  <div class="cabanias-grid">
    <div class="cabin-card">
      <h3>Caba√±a Campanilla</h3>
      <a class="boton" href="cabana-campanilla.html">Ver Caba√±a</a>
    </div>
    <div class="cabin-card">
      <h3>Caba√±a El Tejo</h3>
      <a class="boton" href="cabana-el-tejo.html">Ver Caba√±a</a>
    </div>
  </div>
</section>

<section id="reserva-online">
  <h2>Reserva Online</h2>
  <div class="reserva-box">
    <label>Selecciona caba√±a</label>
    <select id="caba√±a">
      <option value="campanilla">Caba√±a Campanilla</option>
      <option value="tejo">Caba√±a El Tejo</option>
    </select>

    <label>Fecha de entrada</label>
    <input type="date" id="entrada">

    <label>Fecha de salida</label>
    <input type="date" id="salida">

    <label>Nombre completo</label>
    <input type="text" id="nombre">

    <label>Tel√©fono</label>
    <input type="tel" id="telefono">

    <label>Email</label>
    <input type="email" id="email">

    <button onclick="calcularReserva()">Calcular precio</button>

    <div class="spinner" id="spinner"></div>

    <div id="resultado" class="resumen-reserva" style="display:none;">
      <p><strong>Caba√±a:</strong> <span id="caba√±aSeleccionada"></span></p>
      <p><strong>Total:</strong> <span id="total"></span> ‚Ç¨</p>
      <p><strong>Descuento:</strong> <span id="descuento" class="descuento">0</span> ‚Ç¨</p>
      <p><strong>Reserva ahora:</strong> 50 ‚Ç¨</p>
      <p><strong>Resto:</strong> <span id="resto"></span> ‚Ç¨</p>
      <button onclick="reservar()">Pagar</button>
    </div>
  </div>
</section>

<section id="contacto">
  <h2>Contacto</h2>
  <p>üì± <a href="https://wa.me/34620419157">WhatsApp 620 419 157</a></p>
</section>

<footer>
  <p>¬© Caba√±as R√≠o Mundo ¬∑ Ri√≥par</p>
</footer>

<script>
function esTemporadaAlta(fecha){
  const f=new Date(fecha);
  const mes=f.getMonth()+1;
  const dia=f.getDate();
  return (mes==7||mes==8)||(mes==12&&dia>=22)||(mes==1&&dia<=7);
}

function incluyeFinDeSemana(fechaEntrada,noches){
  for(let i=0;i<noches;i++){
    const d=new Date(fechaEntrada);
    d.setDate(d.getDate()+i);
    if(d.getDay()==5||d.getDay()==6) return true;
  }
  return false;
}
</script>

<!-- üî¥ BLOQUEO REAL DESDE BOOKING (iCal) -->
<script>
let fechasOcupadas={campanilla:[],tejo:[]};

async function cargarDisponibilidad(){
  const res=await fetch("https://rafaellabandeira-github-io.onrender.com/api/ical");
  fechasOcupadas=await res.json();
}

function rangoOcupado(caba√±a,entrada,salida){
  const inicio=new Date(entrada);
  const fin=new Date(salida);
  for(let d=new Date(inicio);d<fin;d.setDate(d.getDate()+1)){
    const f=d.toISOString().slice(0,10);
    if(fechasOcupadas[caba√±a]?.includes(f)) return true;
  }
  return false;
}

const calcularOriginal=window.calcularReserva;

window.calcularReserva=async function(){
  await cargarDisponibilidad();

  const caba√±a=document.getElementById("caba√±a").value;
  const entrada=document.getElementById("entrada").value;
  const salida=document.getElementById("salida").value;

  if(rangoOcupado(caba√±a,entrada,salida)){
    alert("Estas fechas ya est√°n reservadas en Booking");
    return;
  }

  calcularOriginal();
}
</script>

</body>
</html>
