<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Caba√±as R√≠o Mundo | Casas Rurales en Ri√≥par</title>

  <meta name="description" content="Caba√±as rurales en Ri√≥par, junto al Nacimiento del R√≠o Mundo. Piscina en verano, entorno natural y contacto directo por WhatsApp.">
  <meta name="keywords" content="caba√±as r√≠o mundo, casas rurales ri√≥par, alojamiento rural albacete">
  <link rel="canonical" href="https://casaruralriomundo.es">
  <link rel="icon" href="images/favicon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="images/favicon.svg">
  
  <link rel="stylesheet" href="css/global.css">
  <link rel="stylesheet" href="css/index.css">
</head>

<body>

<nav class="navbar">
  <div class="nav-container">
    <a href="index.html" class="nav-logo">üè° Caba√±as R√≠o Mundo</a>
    <div class="hamburger" id="hamburger">
      <span></span><span></span><span></span>
    </div>
    <ul class="nav-menu" id="navMenu">
      <li><a href="cabana-campanilla.html" class="nav-link">Campanilla</a></li>
      <li><a href="cabana-el-tejo.html" class="nav-link">El Tejo</a></li>
      <li><a href="https://casaruralriomundo.wordpress.com/" class="nav-link" target="_blank">Experiencias</a></li>
      <li><a href="#contacto" class="nav-link">Contacto</a></li>
    </ul>
  </div>
</nav>

<header class="hero">
  <div class="header-inner">
    <div class="header-text">
      <h1 class="hero-title">Casas rurales en Ri√≥par ¬∑ <span>Complejo El Lagunazo</span></h1>
      <p class="hero-sub">Escapadas, naturaleza y tranquilidad junto al espectacular Nacimiento del R√≠o Mundo</p>
    </div>
  </div>
</header>

<section>
  <h2>Tu escapada rural en Ri√≥par</h2>
  <p>
    Bienvenido a Caba√±as R√≠o Mundo, disponemos de dos acogedoras caba√±as rurales con todas las comodidades.
  </p>
</section>

<section>
  <h2>Nuestras exclusivas Caba√±as</h2>
  <div class="cabanias-grid">
    <div class="cabin-card">
      <h3>Caba√±a Campanilla</h3>
      <p>Capacidad hasta 6 personas.</p>
      <a class="boton" href="cabana-campanilla.html">Ver Caba√±a Campanilla</a>
    </div>

    <div class="cabin-card">
      <h3>Caba√±a El Tejo</h3>
      <p>Ideal para parejas o peque√±as familias.</p>
      <a class="boton" href="cabana-el-tejo.html">Ver Caba√±a El Tejo</a>
    </div>
  </div>
</section>

<!-- üî¥ NUEVA SECCI√ìN DE RESERVAS ONLINE -->
<section id="reservas-online">
  <h2>Reserva Online</h2>
  <p>Consulta disponibilidad y paga la se√±al para confirmar la reserva.</p>

  <form id="formReserva">
    <input type="text" id="nombre" placeholder="Nombre y Apellidos" required>
    <input type="tel" id="telefono" placeholder="Tel√©fono" required>

    <select id="cabana">
      <option value="Campanilla">Campanilla</option>
      <option value="El Tejo">El Tejo</option>
    </select>

    <label>Fecha llegada</label>
    <input type="date" id="fechaInicio" required>

    <label>Fecha salida</label>
    <input type="date" id="fechaFin" required>

    <button type="submit">Calcular precio</button>
  </form>

  <div id="resultadoReserva" style="margin-top:10px;font-weight:bold;"></div>

  <div id="square-card" style="margin-top:20px;"></div>

  <button id="btnPagar" style="display:none;margin-top:10px;">
    Pagar se√±al 50‚Ç¨
  </button>

  <p style="font-size:13px;color:#777;">
    El resto se abonar√° a la llegada.
  </p>
</section>

<section>
  <h2>Ubicaci√≥n</h2>
  <p>üìç Complejo EL Lagunazo, Ri√≥par</p>

  <iframe 
    src="https://www.google.com/maps?q=38.4880635,-2.4343093&z=17&output=embed"
    width="100%" 
    height="350" 
    style="border:0;" 
    allowfullscreen="" 
    loading="lazy">
  </iframe>
</section>

<section id="contacto">
  <h2>Contacto</h2>
  <p>üì± <a href="https://wa.me/34620419157">WhatsApp 620 419 157</a></p>
</section>

<footer>
  <p>
    <a href="aviso-legal.html">Aviso Legal</a> |
    <a href="privacidad.html">Pol√≠tica de Privacidad</a> |
    <a href="cookies.html">Pol√≠tica de Cookies</a>
  </p>
  <p>¬© Caba√±as R√≠o Mundo ¬∑ Ri√≥par</p>
</footer>

<a class="whatsapp" href="https://wa.me/34620419157" title="Contacta por WhatsApp">
  <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
  </svg>
</a>

<script src="js/main.js"></script>

<!-- üî¥ SCRIPT RESERVAS + SQUARE -->
<script type="module">
import { Payments } from "https://web.squarecdn.com/v1/square.js";

/* ‚ö†Ô∏è URL de tu backend en Render */
const BACKEND = "https://rafaellabandeira-github-io.onrender.com";

/* ‚úÖ Tus credenciales de Square */
const payments = Payments("sq0idp-Ue7cMnZzU1fLD0l8u0lpcg", "LA6ZV4WAES4A0");

const card = await payments.card();
await card.attach("#square-card");

document.getElementById("formReserva").addEventListener("submit", async (e) => {
  e.preventDefault();

  const cabana = document.getElementById("cabana").value;
  const fechaInicio = document.getElementById("fechaInicio").value;
  const fechaFin = document.getElementById("fechaFin").value;

  const res = await fetch(`${BACKEND}/calculate-price`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ cabana, fechaInicio, fechaFin })
  });

  const data = await res.json();

  document.getElementById("resultadoReserva").innerHTML =
    `Precio total estancia: ${data.precio} ‚Ç¨`;

  document.getElementById("btnPagar").style.display = "inline-block";
});

document.getElementById("btnPagar").addEventListener("click", async () => {

  const nombre = document.getElementById("nombre").value;
  const telefono = document.getElementById("telefono").value;
  const cabana = document.getElementById("cabana").value;

  const result = await card.tokenize();

  if (result.status === "OK") {

    await fetch(`${BACKEND}/create-payment`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        nonce: result.token,
        amount: 50,
        nombre,
        telefono,
        cabana
      })
    });

    alert("Reserva confirmada correctamente.");
    location.reload();
  } else {
    alert("Error en el pago");
  }
});
</script>

</body>
</html>
